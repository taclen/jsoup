


<!DOCTYPE html>


<html lang="zh-CN">
<head>
<meta charset="UTF-8"/>	
<meta name="viewport" content="width=device-width, initial-scale=1"/>      
<link rel="icon" href="//www.ibm.com/favicon.ico"/>
<link rel="canonical" href="http://www.ibm.com/developerworks/cn/java/j-lo-jsouphtml/index.html"/>
<meta name="geo.country" content="CN"/>
<meta name="dcterms.rights" content="© Copyright IBM Corporation 2011"/>
<meta name="dcterms.date" content="2011-03-02"/>
<meta name="description" content="jsoup 是一款 Java 的 HTML 解析器，可直接解析某个 URL 地址、HTML 文本内容。它提供了一套非常省力的 API，可通过 DOM，CSS 以及类似于 jQuery 的操作方法来取出和操作数据。本文主要介绍如何使用 jsoup 来进行常用的 HTML 解析。"/>	
<meta name="keywords" content="HTML, 解析, jsoup, tttjca, tttwaca"/>
<meta name="robots" content="index,follow"/>
<title>使用 jsoup 对 HTML 文档进行解析和操作</title>
    
<script> 
    digitalData = {
        "page":{
            "category":{
                "primaryCategory":"SOFDCJVACN"
            },
            "pageInfo":{
                "effectiveDate":"2011-03-02",
                "language":"zh-CN",
                "publishDate":"2011-03-02",
                "publisher":"IBM Corporation",
                "version":"v18",
                "ibm":{ 
                    "contentDelivery":"IBM developerWorks template",
                    "contentProducer":"IBM developerWorks",
                    "country":"CN",
                    "owner":"developerWorks/China/IBM",
                    "siteID":"DEVWRKS",
                    "subject":"TT300",
                    "type":"CT316",
                    "topic":"API,应用开发,DHTML (Dynamic HTML),HTML,JavaScript,XML,AJAX,技巧",
                    "topicId":"125,263,100,69,107,2,725,62",
                    "contentArea":"java,web",
                    "contentAreaId":"1,5",
                    "contentType":"article",
                    "contentId":"630256",
                },
                "keywords":"HTML, 解析, jsoup, tttjca, tttwaca",
                "description":"jsoup 是一款 Java 的 HTML 解析器，可直接解析某个 URL 地址、HTML 文本内容。它提供了一套非常省力的 API，可通过 DOM，CSS 以及类似于 jQuery 的操作方法来取出和操作数据。本文主要介绍如何使用 jsoup 来进行常用的 HTML 解析。"
            }
        }
    };
    window._analytics = {
        "coremetrics": false,
        "optimizely": false,
        "googleAddServices": false,
        "addRoll": false,
        "intercom": false,
        "fullStory": false,
        "hotjar": false,
        "tealeaf": false,
        "nps": false,
        "segment_key": 'HU3dbkAG5wE0F1IkRf9S1RexlAqo3jby'
    };
</script>
	
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:site" content="@developerworks"/>
<meta property="og:title" content="使用 jsoup 对 HTML 文档进行解析和操作"/>
<meta property="og:description" content="jsoup 是一款 Java 的 HTML 解析器，可直接解析某个 URL 地址、HTML 文本内容。它提供了一套非常省力的 API，可通过 DOM，CSS 以及类似于 jQuery 的操作方法来取出和操作数据。本文主要介绍如何使用 jsoup 来进行常用的 HTML 解析。"/>
    <meta property="og:image" content="http://www.ibm.com/developerworks/i/dw-social-201508.png"/>
<!-- Segment meta tag -->
<meta name="segment" property="developerWorks (developerWorks)" productTitle="developerWorks" value="Java Chinese (developerWorks)"/>      
<!-- SITE MON : START (DO NOT DELETE) -->
<!-- developerWorks monitoring token -->
<!-- SITE MON : END (DO NOT DELETE) -->

<!-- HEADER_SCRIPTS_AND_CSS_INCLUDE -->
<!-- <script src="//cdn.optimizely.com/js/5399420604.js"></script> -->
<!-- BEGIN: Use this section to set page specific variables for the Page Tag -->
<script language="JavaScript">var NTPT_PGEXTRA="ibmSkillLevel=3&ibmCmaId=630256&ibmContentAreas=java,web";</script>
<!--END -->
<script src="//1.www.s81c.com/common/stats/ida_stats.js"></script>
<link href="//1.www.s81c.com/common/v18/css/www.css" rel="stylesheet">
<link href="//1.www.s81c.com/common/v18/css/syntaxhighlighter.css" rel="stylesheet">
<script src="//1.www.s81c.com/common/v18/js/www.js"></script>
<script src="//1.www.s81c.com/common/v18/js/syntaxhighlighter.js"></script>    
<link href="//1.www.s81c.com/common/v18/css/tables.css" rel="stylesheet">
<script src="//1.www.s81c.com/common/v18/js/tables.js"></script>   
<!--  Masthead/footer  -->
<link href="//dw1.s81c.com/developerworks/css/dw-mf/v18/dw-mf-v18.css?v=111618" rel="stylesheet">
<!-- <link href="//dw1.s81c.com/developerworks/css/dw-mf/v18/alt-signedin-ux.css" rel="stylesheet" /> -->   
<!--[if lt IE 9]>
    <link href="//dw1.s81c.com/developerworks/css/dw-mf/v18/dw-mf-ie8fix.css?v=022216" rel="stylesheet" />
<![endif]-->
<link href="//dw1.s81c.com/developerworks/css/v18/dw-article.css?v=012418" rel="stylesheet">
<script src="//dw1.s81c.com/developerworks/js/v18/dw-auth-properties.js?v=041017"></script>
<script src="//dw1.s81c.com/developerworks/js/v18/dw-auth.js?v=031119"></script>
<script src="//dw1.s81c.com/developerworks/js/dw-mf/v18/dw-mf.js?v=050618"></script>
<script src="//dw1.s81c.com/developerworks/js/v18/dw-include.js"></script>     
<script src="//dw1.s81c.com/developerworks/js/v18/dw-article.js?v=050818"></script>
<script src="//dw1.s81c.com/developerworks/js/v18/dw-auto-links.js?v=121217"></script>     
<script src="//www.ibm.com/software/info/js/tactic.js"></script>
<script src="//www.ibm.com/software/info/js/tacticbindlinks.js"></script>

<!-- 
<PageMap>
    <DataObject type="document">
        <Attribute name="topic">API,应用开发,DHTML (Dynamic HTML),HTML,JavaScript,XML,AJAX,技巧</Attribute>
        <Attribute name="topicId">125,263,100,69,107,2,725,62</Attribute>
        <Attribute name="contentArea">java,web</Attribute>
        <Attribute name="contentAreaId">1,5</Attribute>
        <Attribute name="abstract">jsoup 是一款 Java 的 HTML 解析器，可直接解析某个 URL 地址、HTML 文本内容。它提供了一套非常省力的 API，可通过 DOM，CSS 以及类似于 jQuery 的操作方法来取出和操作数据。本文主要介绍如何使用 jsoup 来进行常用的 HTML 解析。</Attribute>
        <Attribute name="pub.date">2011-03-02</Attribute>
        <Attribute name="contentType">article</Attribute>
    </DataObject>
</PageMap>
-->        

</head>
<body id="ibm-com" class="ibm-type dw-js-disabled">
	
<div id="ibm-top" class="ibm-landing-page">

<!-- MASTHEAD_BEGIN -->
<div id="ibm-masthead" role="banner" aria-label="IBM">
    <div id="ibm-universal-nav">    
  
        <nav role="navigation" aria-label="IBM">
            <div id="ibm-home"><a href="https://www.ibm.com/cn/zh/">IBM®</a></div>
            <ul id="ibm-menu-links" role="toolbar" aria-label="站点地图">
                <li><a href="https://www.ibm.com/sitemap/cn/zh/">站点地图</a></li>
            </ul> 
        </nav>
  
        <div id="ibm-search-module" role="search" aria-labelledby="ibm-masthead">
            <form id="ibm-search-form" action="https://www.ibm.com/Search/" method="get">
                <p>
                    <label for="q">IBM</label>
                    <input type="text" maxlength="100" value="" placeholder="搜索" name="q" id="q" aria-label="搜索 IBM Developer"/>
                    <input type="hidden" value="utf" name="en"/>
                    <input type="hidden" value="zh" name="lang"/>
                    <input type="hidden" value="cn" name="cc"/>
                    <input type="hidden" value="20" name="nr"/>
                    <input type="hidden" value="For developers" name="tabType[0]"/>
                    <input type="submit" id="ibm-search" class="ibm-btn-search" value="提交"/>
                </p>
            </form>
        </div>
       
    </div>
</div><!-- MASTHEAD_END -->
	    
<!-- LAYOUT -->
<div id="ibm-content-wrapper">
    <!-- LEADSPACE_BEGIN -->
    <header role="banner" aria-labelledby="ibm-pagetitle-h1">
        
        <!-- MASTHEAD_SITENAV_BEGIN -->
        <div class="ibm-sitenav-menu-container">
    <div class="ibm-sitenav-menu-name">
        <a href="//www.ibm.com/developerworks/cn/">IBM Developer</a>
    </div>
    <div class="ibm-sitenav-menu-list">
        <ul role="menubar">
            <li role="presentation">
                <a href="//www.ibm.com/developerworks/cn/topics/" role="menuitem">学习</a>
            </li>
            <li role="presentation">
                <a href="//www.ibm.com/developerworks/cn/downloads/" role="menuitem">开发</a>
            </li>
            <li role="presentation">
                <!-- <a href="//www.ibm.com/developerworks/cn/community/" role="menuitem">社区</a> -->
                <a href="//www.ibm.com/developerworks/community/groups/service/html/communityview?communityUuid=3302cc3b-074e-44da-90b1-5055f1dc0d9c" role="menuitem">社区</a>
            </li>
            <li class="ibm-sitenav-menu-item-right">
                <a href="//www.ibm.com/ibm/cn/partners/start/" role="menuitem">合作</a>
            </li>
        </ul>
    </div>
</div>
<!-- BEGIN IBM DEVELOPER BANNER -->
<!-- <style>
    #dw-mast-banner {
        background: #000;
        box-sizing: border-box;
    }
    #dw-mast-banner.ibm-band, #dw-mast-strip.ibm-band { padding: 0; }
    #dw-mast-banner p { color: #ffffff; margin-left: 1rem; display: inline-block; text-decoration: none; font-size: 1.125rem; }
    #dw-mast-banner .dw-mast-banner-cta { padding-left: 10px; color: #ed1c24; }
    #dw-mast-banner .dw-mast-banner-cta::after { content: "\003e"; color: #ed1c24; font-size: 0.875rem; padding-left: 4px; }
    #dw-mast-banner img { display: inline-block; vertical-align: middle; margin-top: -4px; }
    #dw-mast-banner .dw-mast-banner-img { margin-left: 16px; }
    #dw-mast-strip {
        background-color: #e9e9e9;
        box-sizing: border-box;
    }
    #dw-mast-strip p { padding: 10px 20px 10px; margin-left: 2rem; color: #000; display: block; text-decoration: none; font-size: 1rem; }

    @media only screen and (max-width:800px) {
    #dw-mast-banner p { margin-right: 1rem; }
    }
    @media only screen and (max-width:525px) {
    #dw-mast-banner .dw-mast-banner-cta { padding-left: 4px; }
    }
</style>
<div id="dw-mast-banner" class="ibm-band" style="text-align: center">
    <a href="https://www.ibm.com/cn-zh/cloud/redhat">
        <div style="display:inline-block">
            <img src="https://dw1.s81c.com/developerworks/i/dw-ibmred.png" height="60" width="201" alt="IBM and Red Hat logos"/>
            <p class="ibm-plex-sans-semibold">IBM 和 Red Hat - 开放创新的新篇章。 <span class="dw-mast-banner-cta ibm-plex-sans-semibold">了解更多</span></p>
        </div>
    </a>
</div> -->
<!-- <div id="dw-mast-strip" class="ibm-band" style="text-align: center">
    <div>
        <p>developerWorks 中国 正在向 IBM Developer 过渡。 我们将为您呈现一个全新的界面和更新的主题领域，并一如既往地提供您希望获得的精彩内容。</p>
    </div>
</div> -->
<!-- <div class="code_adorn_announcement" id="code_announcement">
  <div class="code_content__wrap">
  <style>
    .dc-announcement{
      background: #e9e9e9;
      min-height: 53px;
      box-sizing: border-box;
      padding-top: 10px;
      padding-bottom: 10px;
      border-bottom: 1px solid #1e1e1e;
    }
    .dc-announcement p{
      text-align: center;
      font-size: 1.125rem;
      line-height: 1.625rem;
      font-weight: 300;
      padding: 0 20px;
    }
    .dc-announcement a p{
      display: table;
      color: #1e1e1e;
      width: auto;
      margin: 0 auto;
    }
    .dc-announcement a {
      text-decoration: none;
      display: block;
      text-align: center;
    }
    .dc-announcement a p strong{
      color: #fff !important;
      padding: 10px 20px !important;
      margin-left: 10px;
      display: inline-block;
      background-color: rgb(0, 98, 255);
      font-weight: 600;
      font-size: 1.2rem;
      margin-top: 10px;
      margin-bottom: 10px;
    }
    .dc-announcement a p span{
      font-weight: 600;
    }
  </style>
  <div class="dc-announcement">
    <a href="https://developer.ibm.com/cn/digitalconference/">
      <p><span>Digital Developer Conference:</span> 专注于云计算和人工智能的免费半天在线会议：欧洲，11 月 14 日 亚洲，11 月 23 日 <strong>立即注册</strong></p>
    </a>
  </div>
</div>
</div> -->
 <style>
    #dw-mast-banner {
        background-color: #000;
        /* min-height: 75px; */
    }
    #dw-mast-banner.ibm-band { padding: 0; position: static; animation: none; }
    #dw-mast-banner .ibm-columns { padding: 0; min-height: 100px; }
    #dw-mast-banner .dw-mast-banner-txt { padding: 15px 20px 0; color: #4ca7a5; display: inline; }
    #dw-mast-banner .dw-mast-banner-cta { padding: 14px 0 0 20px; margin-right: 2rem; color: #4ca7a5; display: inline; }
    #dw-mast-banner .dw-mast-banner-txt p.ibm-h4 { font-size: 1.125rem; }
    #dw-mast-banner .dw-mast-banner-txt span { white-space: nowrap; }
    #dw-mast-banner .ibm-btn-pri {
        background-color: #000;
        border: 1px solid #4ca7a5;
        color: #4ca7a5;
    }
    #dw-mast-banner .ibm-btn-pri:hover {
        background-color: #4ca7a5;
        color: #fff;
    }
    @media only screen and (max-width:1100px) {
        #dw-mast-banner .dw-mast-banner-cta { padding: 10px 0 0 20px; }
        #dw-mast-banner .dw-mast-banner-txt p.ibm-h4 { font-size: 1.0rem; }
    }
    @media only screen and (max-width:999px) {
        #dw-mast-banner .dw-mast-banner-txt { margin-left: 0.5rem; }
        #dw-mast-banner .dw-mast-banner-cta { margin-right: 0.5rem; }
    }
    @media only screen and (max-width:959px) {
        #dw-mast-banner .dw-mast-banner-txt { margin-left: 2rem; }
        #dw-mast-banner .dw-mast-banner-cta { margin-right: 2rem; }
        #dw-mast-banner .ibm-btn-pri { white-space: nowrap; font-size: .875rem; }
        #dw-mast-banner .dw-mast-banner-txt p.ibm-h4 {
            font-size: .9375rem;
            text-align: center;
            font-weight: 400;
        }
    }
    @media only screen and (max-width:600px) {
        #dw-mast-banner .dw-mast-banner-txt { margin-left: 1rem; }
        #dw-mast-banner .dw-mast-banner-cta { margin-right: 1rem; }
    }
    @media only screen and (max-width:579px) {
        #dw-mast-banner .dw-mast-banner-txt, #dw-mast-banner .dw-mast-banner-cta { display: block; }
        #dw-mast-banner .dw-mast-banner-txt { margin-left: 1rem; margin-right: 1rem; }
        #dw-mast-banner .dw-mast-banner-cta { margin-right: 0; text-align: center; }
        #dw-mast-banner .dw-mast-banner-txt p.ibm-h4 { padding: 0; }
        #dw-mast-banner .dw-mast-banner-cta { padding: 10px 0 0 0; }
    }
</style>
<div id="dw-mast-banner" class="ibm-band">
    <div class="ibm-vertical-center">
        <div class="ibm-center-block ibm-vertical-center">
            <div class="dw-mast-banner-txt ibm-plex-sans-regular">
                <p class="ibm-h4">developerWorks 中国 正在向 IBM Developer 过渡。 我们将为您呈现一个全新的界面和更新的主题领域，并一如既往地提供您希望获得的精彩内容。</p>
            </div>
        </div>
    </div>
</div>
        <!-- MASTHEAD_SITENAV_END -->
        
        <!-- NAVIGATION_TRAIL_BEGIN -->
        <div id="ibm-leadspace-head" class="ibm-alternate">
            <div id="ibm-leadspace-body">
                <nav aria-label="Breadcrumb" role="navigation">                     
                            <ul id="dw-navigation-trail" itemscope="" itemtype="http://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem"><a itemprop="item" href="http://www.ibm.com/developerworks/cn/topics/"><span itemprop="name">学习</span></a><meta itemprop="position" content="1"/></li><li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem"><a itemprop="item" href="http://www.ibm.com/developerworks/cn/java/"><span itemprop="name">Java technology</span></a><meta itemprop="position" content="2"/></li></ul>
                </nav>
            </div>
        </div>
        <!-- NAVIGATION_TRAIL_END -->
        
    </header>
    <!-- LEADSPACE_END -->
    
    <!-- MAIN_CONTENT_BEGIN -->
    <main role="main" aria-labelledby="ibm-pagetitle-h1"> 
        <div id="ibm-pcon">
            <!-- BEGIN_IBM-CONTENT -->
            <div id="ibm-content">
                <!-- BEGIN_IBM-CONTENT-BODY -->
                <div id="ibm-content-body">
                    <!-- BEGIN_IBM-CONTENT-MAIN -->
                    <div id="ibm-content-main" class="dw-article">                        
                        <!-- BEGIN_INTERIOR-COLUMNS -->
                                <div class="ibm-columns dw-article-toc">
                                    <!-- LEFT_6_2_CONTENT_COLUMN_BEGIN -->  
                                    <div id="dw-article-toc-container" class="ibm-col-6-2">
                                        <div id="dw-article-toc-body">
                                            <h2>内容</h2><div class="ibm-alternate-rule"><hr/></div><ul role="directory" aria-label="内容" class="ibm-plain-list"><li><a href="#ibm-pagetitle-h1">概览</a></li><li><a href="#1jsoup简介outline">jsoup 简介</a></li><li><a href="#2文档输入outline">文档输入</a></li><li><a href="#3解析并提取HTML元素outline">解析并提取 HTML 元素</a></li><li><a href="#4修改数据outline">修改数据</a></li><li><a href="#5HTML文档清理outline">HTML 文档清理</a></li><li><a href="#6jsoup的过人之处——选择器outline">jsoup 的过人之处——选择器</a></li><li><a href="#7总结outline">总结</a></li><li><a href="#artrelatedtopics">相关主题</a></li><li><a href="#icomments">评论</a></li></ul>
                                        </div>
                                    </div>
                                    <!-- LEFT_6_2_CONTENT_COLUMN_END -->
                                    
                                    <!-- CENTER_6_4_CONTENT_COLUMN_BEGIN -->
                                    <div class="ibm-col-6-4">
                                        <h1 id="ibm-pagetitle-h1" class="ibm-h1">使用 jsoup 对 HTML 文档进行解析和操作		</h1>
                                        <!-- Article Top Bar -->
                                                <div class="ibm-columns dw-article-topbar">
                                                    <!-- Author and article info. -->
                                                    <div class="ibm-col-6-2 ibm-col-medium-6-4 dw-article-metadata">
                                                        <div class="dw-article-avatar"><img width="42" height="42" src="//dw1.s81c.com/developerworks/i/v18/article/dw-author.png" alt=""/></div><div class="dw-article-authordate">刘 柄成<br /><span class="dw-article-pubdate">2011 年 3 月 02 日发布</span></div>
                                                    </div>
                                                    <!-- Social -->
                                                    <div class="ibm-col-6-2 ibm-col-medium-6-4 ibm-col-small-6-2 dw-article-social">
                                                        <!-- Sharing links -->
                                                        <div id="dw-article-share-inline">
                                                            <div class="dw-article-sharelink-inline">
                                                                <div class="ibm-sharethispage"></div>
                                                            </div>
                                                        </div>
                                                        <!-- Number of comments and link to comments -->
                                                        <div id="dw-article-cmts">
                                                            <div class="dw-article-cmtslink">
                                                                <a onclick="tocLink('#icomments')" href="#icomments" role="link" tabindex="0" aria-label="Comments">
                                                                    <img src="//dw1.s81c.com/developerworks/i/v18/article/dw-article-cmt-icon.png" width="29" height="29" alt="Comments"/>
                                                                </a>
                                                            </div>
                                                            <div class="dw-article-cmtslink">
                                                                <a onclick="tocLink('#icomments')" href="#icomments" role="link" tabindex="0">
                                                                    <div id="nCmts"></div>
                                                                </a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                        <!-- Article Body -->
                                        
                                        <h2 id="1jsoup简介outline" class="ibm-h2">jsoup 简介</h2><p>Java 程序在解析 HTML 文档时，相信大家都接触过 htmlparser 这个开源项目，我曾经在 IBM DW 上发表过两篇关于 htmlparser 的文章，分别是：<a href="http://www.ibm.com/developerworks/cn/java/l-html-parser/">从 HTML 中攫取你所需的信息</a>和 <a href="http://www.ibm.com/developerworks/cn/opensource/os-htmlparser/">扩展 HTMLParser 对自定义标签的处理能力</a>。但现在我已经不再使用 htmlparser 了，原因是 htmlparser 很少更新，但最重要的是有了 jsoup 。</p><p>jsoup 是一款 Java 的 HTML 解析器，可直接解析某个 URL 地址、HTML 文本内容。它提供了一套非常省力的 API，可通过 DOM，CSS 以及类似于 jQuery 的操作方法来取出和操作数据。</p><p>jsoup 的主要功能如下：</p><p> 1. 从一个 URL，文件或字符串中解析 HTML；</p><p> 2. 使用 DOM 或 CSS 选择器来查找、取出数据；</p><p> 3. 可操作 HTML 元素、属性、文本；</p><p>jsoup 是基于 MIT 协议发布的，可放心使用于商业项目。</p><p>jsoup 的主要类层次结构如图 1 所示：</p><h5 id="N10056" class="ibm-h5">图 1. jsoup 的类层次结构</h5><img src="image003.jpg" class="ibm-downsize" alt="图 1. jsoup 的类层次结构" height="200" width="468"/><p class="ibm-ind-link"><a class="ibm-popup-link" onclick="IBMCore.common.widget.overlay.show('N1005A');return false;" href="#N1005A">点击查看大图</a></p><div class="ibm-common-overlay ibm-overlay-alt-three" data-widget="overlay" id="N1005A"><img alt="图 1. jsoup 的类层次结构" src="image003.jpg" width="468" /></div><p>接下来我们专门针对几种常见的应用场景举例说明 jsoup 是如何优雅的进行 HTML 文档处理的。</p><h2 id="2文档输入outline" class="ibm-h2">文档输入</h2><p>jsoup 可以从包括字符串、URL 地址以及本地文件来加载 HTML 文档，并生成 Document 对象实例。</p><p>下面是相关代码：</p><h5 id="N1006C" class="ibm-h5">清单 1</h5><span class="dw-code-nohighlight"><pre data-widget="syntaxhighlighter" class="brush: js; html-script: true; gutter: true;"> // 直接从字符串中输入 HTML 文档
 String html = "&lt;html&gt;&lt;head&gt;&lt;title&gt; 开源中国社区 &lt;/title&gt;&lt;/head&gt;"
  + "&lt;body&gt;&lt;p&gt; 这里是 jsoup 项目的相关文章 &lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"; 
 Document doc = Jsoup.parse(html); 

 // 从 URL 直接加载 HTML 文档
 Document doc = Jsoup.connect("http://www.oschina.net/").get(); 
 String title = doc.title(); 

 Document doc = Jsoup.connect("http://www.oschina.net/") 
  .data("query", "Java")   // 请求参数
  .userAgent("I ’ m jsoup") // 设置 User-Agent 
  .cookie("auth", "token") // 设置 cookie 
  .timeout(3000)           // 设置连接超时时间
  .post();                 // 使用 POST 方法访问 URL 

 // 从文件中加载 HTML 文档
 File input = new File("D:/test.html"); 
 Document doc = Jsoup.parse(input,"UTF-8","http://www.oschina.net/");</pre></span><p>请大家注意最后一种 HTML 文档输入方式中的 parse 的第三个参数，为什么需要在这里指定一个网址呢（虽然可以不指定，如第一种方法）？因为 HTML 文档中会有很多例如链接、图片以及所引用的外部脚本、css 文件等，而第三个名为 baseURL 的参数的意思就是当 HTML 文档使用相对路径方式引用外部文件时，jsoup 会自动为这些 URL 加上一个前缀，也就是这个 baseURL。</p><p>例如 &lt;a href=/project&gt; 开源软件 &lt;/a&gt; 会被转换成 &lt;a href=http://www.oschina.net/project&gt; 开源软件 &lt;/a&gt;。</p><h2 id="3解析并提取HTML元素outline" class="ibm-h2">解析并提取 HTML 元素</h2><p>这部分涉及一个 HTML 解析器最基本的功能，但 jsoup 使用一种有别于其他开源项目的方式——选择器，我们将在最后一部分详细介绍 jsoup 选择器，本节中你将看到 jsoup 是如何用最简单的代码实现。</p><p>不过 jsoup 也提供了传统的 DOM 方式的元素解析，看看下面的代码：</p><h5 id="N10081" class="ibm-h5">清单 2.</h5><span class="dw-code-nohighlight"><pre data-widget="syntaxhighlighter" class="brush: js; html-script: true; gutter: true;"> File input = new File("D:/test.html"); 
 Document doc = Jsoup.parse(input, "UTF-8", "http://www.oschina.net/"); 

 Element content = doc.getElementById("content"); 
 Elements links = content.getElementsByTag("a"); 
 for (Element link : links) { 
  String linkHref = link.attr("href"); 
  String linkText = link.text(); 
 }</pre></span><p>你可能会觉得 jsoup 的方法似曾相识，没错，像 getElementById 和 getElementsByTag 方法跟 JavaScript 的方法名称是一样的，功能也完全一致。你可以根据节点名称或者是 HTML 元素的 id 来获取对应的元素或者元素列表。</p><p>与 htmlparser 项目不同的是，jsoup 并没有为 HTML 元素定义一个对应的类，一般一个 HTML 元素的组成部分包括：节点名、属性和文本，jsoup 提供简单的方法供你自己检索这些数据，这也是 jsoup 保持瘦身的原因。</p><p>而在元素检索方面，jsoup 的选择器简直无所不能，</p><h5 id="N10093" class="ibm-h5">清单 3.</h5><span class="dw-code-nohighlight"><pre data-widget="syntaxhighlighter" class="brush: js; html-script: true; gutter: true;"> File input = new File("D:\test.html"); 
 Document doc = Jsoup.parse(input,"UTF-8","http://www.oschina.net/"); 

 Elements links = doc.select("a[href]"); // 具有 href 属性的链接
 Elements pngs = doc.select("img[src$=.png]");// 所有引用 png 图片的元素


 Element masthead = doc.select("div.masthead").first(); 
 // 找出定义了 class=masthead 的元素

 Elements resultLinks = doc.select("h3.r &gt; a"); // direct a after h3</pre></span><p>这是 jsoup 真正让我折服的地方，jsoup 使用跟 jQuery 一模一样的选择器对元素进行检索，以上的检索方法如果换成是其他的 HTML 解释器，至少都需要很多行代码，而 jsoup 只需要一行代码即可完成。</p><p>jsoup 的选择器还支持表达式功能，我们将在最后一节介绍这个超强的选择器。</p><h2 id="4修改数据outline" class="ibm-h2">修改数据</h2><p>在解析文档的同时，我们可能会需要对文档中的某些元素进行修改，例如我们可以为文档中的所有图片增加可点击链接、修改链接地址或者是修改文本等。</p><p>下面是一些简单的例子：</p><h5 id="N100AA" class="ibm-h5">清单 4.</h5><span class="dw-code-nohighlight"><pre data-widget="syntaxhighlighter" class="brush: js; html-script: true; gutter: true;"> doc.select("div.comments a").attr("rel", "nofollow"); 
 // 为所有链接增加 rel=nofollow 属性
 doc.select("div.comments a").addClass("mylinkclass"); 
 // 为所有链接增加 class=mylinkclass 属性
 doc.select("img").removeAttr("onclick"); // 删除所有图片的 onclick 属性
 doc.select("input[type=text]").val(""); // 清空所有文本输入框中的文本</pre></span><p>道理很简单，你只需要利用 jsoup 的选择器找出元素，然后就可以通过以上的方法来进行修改，除了无法修改标签名外（可以删除后再插入新的元素），包括元素的属性和文本都可以修改。</p><p>修改完直接调用 Element(s) 的 html() 方法就可以获取修改完的 HTML 文档。</p><h2 id="5HTML文档清理outline" class="ibm-h2">HTML 文档清理</h2><p>jsoup 在提供强大的 API 同时，人性化方面也做得非常好。在做网站的时候，经常会提供用户评论的功能。有些用户比较淘气，会搞一些脚本到评论内容中，而这些脚本可能会破坏整个页面的行为，更严重的是获取一些机要信息，例如 XSS 跨站点攻击之类的。</p><p>jsoup 对这方面的支持非常强大，使用非常简单。看看下面这段代码：</p><h5 id="N100BF" class="ibm-h5">清单 5.</h5><span class="dw-code-nohighlight"><pre data-widget="syntaxhighlighter" class="brush: js; html-script: true; gutter: true;"> String unsafe = "&lt;p&gt;&lt;a href='http://www.oschina.net/' onclick='stealCookies()'&gt; 
 开源中国社区 &lt;/a&gt;&lt;/p&gt;"; 
 String safe = Jsoup.clean(unsafe, Whitelist.basic()); 
 // 输出 : 
 // &lt;p&gt;&lt;a href="http://www.oschina.net/" rel="nofollow"&gt; 开源中国社区 &lt;/a&gt;&lt;/p&gt;</pre></span><p>jsoup 使用一个 Whitelist 类用来对 HTML 文档进行过滤，该类提供几个常用方法：</p><h5 id="N100CD" class="ibm-h5">表 1. 常用方法：</h5><table border="0" cellpadding="0" cellspacing="0" class="ibm-data-table" data-widget="datatable"><thead xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><tr><th class="ibm-background-neutral-white-30"><strong>方法名</strong></th><th class="ibm-background-neutral-white-30"><strong>简介</strong></th></tr></thead><tbody xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><tr><td>
 none() 
</td><td>
只允许包含文本信息
</td></tr><tr><td>
 basic() 
</td><td>
允许的标签包括：a, b, blockquote, br, cite, code, dd, dl, dt, em, i, li, ol, p, pre, q, small, strike, strong, sub, sup, u, ul, 以及合适的属性
</td></tr><tr><td>
 simpleText() 
</td><td>
只允许 b, em, i, strong, u 这些标签
</td></tr><tr><td>
 basicWithImages() 
</td><td>
在 basic() 的基础上增加了图片
</td></tr><tr><td>
 relaxed() 
</td><td>
这个过滤器允许的标签最多，包括：a, b, blockquote, br, caption, cite, code, col, colgroup, dd, dl, dt, em, h1, h2, h3, h4, h5, h6, i, img, li, ol, p, pre, q, small, strike, strong, sub, sup, table, tbody, td, tfoot, th, thead, tr, u, ul 
</td></tr></tbody></table><p>如果这五个过滤器都无法满足你的要求呢，例如你允许用户插入 flash 动画，没关系，Whitelist 提供扩展功能，例如 whitelist.addTags("embed","object","param","span","div"); 也可调用 addAttributes 为某些元素增加属性。</p><h2 id="6jsoup的过人之处——选择器outline" class="ibm-h2">jsoup 的过人之处——选择器</h2><p>前面我们已经简单的介绍了 jsoup 是如何使用选择器来对元素进行检索的。本节我们把重点放在选择器本身强大的语法上。下表是 jsoup 选择器的所有语法详细列表。</p><h5 id="N10104" class="ibm-h5">表 2. 基本用法：</h5><table border="0" cellpadding="0" cellspacing="0" class="ibm-data-table" data-widget="datatable"><thead xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><tr><th class="ibm-background-neutral-white-30">tagname</th><th class="ibm-background-neutral-white-30">
使用标签名来定位，例如 a 
</th></tr></thead><tbody xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><tr><td><strong>ns|tag</strong></td><td>
使用命名空间的标签定位，例如 fb:name 来查找 &lt;fb:name&gt; 元素
</td></tr><tr><td><strong>#id</strong></td><td>
使用元素 id 定位，例如 #logo 
</td></tr><tr><td><strong>.class</strong></td><td>
使用元素的 class 属性定位，例如 .head 
</td></tr><tr><td><strong>[attribute]</strong></td><td>
使用元素的属性进行定位，例如 [href] 表示检索具有 href 属性的所有元素
</td></tr><tr><td><strong>[^attr]</strong></td><td>
使用元素的属性名前缀进行定位，例如 [^data-] 用来查找 HTML5 的 dataset 属性
</td></tr><tr><td><strong>[attr=value]</strong></td><td>
使用属性值进行定位，例如 [width=500] 定位所有 width 属性值为 500 的元素
</td></tr><tr><td><strong>[attr^=value], [attr$=value], [attr*=value]</strong></td><td>
这三个语法分别代表，属性以 value 开头、结尾以及包含
</td></tr><tr><td><strong>[attr~=regex]</strong></td><td>
使用正则表达式进行属性值的过滤，例如 img[src~=(?i)\.(png|jpe?g)] 
</td></tr><tr><td><strong>*</strong></td><td>
定位所有元素
</td></tr></tbody></table><p>以上是最基本的选择器语法，这些语法也可以组合起来使用，下面是 jsoup 支持的组合用法：</p><h5 id="N1014F" class="ibm-h5">表 3：组合用法：</h5><table border="0" cellpadding="0" cellspacing="0" class="ibm-data-table" data-widget="datatable"><thead xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><tr><th class="ibm-background-neutral-white-30">el#id</th><th class="ibm-background-neutral-white-30">
定位 id 值某个元素，例如 a#logo -&gt; &lt;a id=logo href= … &gt; 
</th></tr></thead><tbody xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><tr><td><strong>el.class</strong></td><td>
定位 class 为指定值的元素，例如 div.head -&gt; &lt;div class=head&gt;xxxx&lt;/div&gt; 
</td></tr><tr><td><strong>el[attr]</strong></td><td>
定位所有定义了某属性的元素，例如 a[href] 
</td></tr><tr><td><strong>以上三个任意组合</strong></td><td>
例如 a[href]#logo 、a[name].outerlink 
</td></tr><tr><td><strong>ancestor child</strong></td><td>
这五种都是元素之间组合关系的选择器语法，其中包括父子关系、合并关系和层次关系。
</td></tr><tr><td><strong>parent &gt; child</strong></td></tr><tr><td><strong>siblingA + siblingB</strong></td></tr><tr><td><strong>siblingA ~ siblingX</strong></td></tr><tr><td><strong>el, el, el</strong></td></tr></tbody></table><p>除了一些基本的语法以及这些语法进行组合外，jsoup 还支持使用表达式进行元素过滤选择。下面是 jsoup 支持的所有表达式一览表：</p><h5 id="N1018C" class="ibm-h5">表 4. 表达式：</h5><table border="0" cellpadding="0" cellspacing="0" class="ibm-data-table" data-widget="datatable"><thead xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><tr><th class="ibm-background-neutral-white-30">:lt(n)</th><th class="ibm-background-neutral-white-30">
例如 td:lt(3) 表示 小于三列
</th></tr></thead><tbody xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><tr><td><strong>:gt(n)</strong></td><td>
 div p:gt(2) 表示 div 中包含 2 个以上的 p 
</td></tr><tr><td><strong>:eq(n)</strong></td><td>
 form input:eq(1) 表示只包含一个 input 的表单
</td></tr><tr><td><strong>:has(seletor)</strong></td><td>
 div:has(p) 表示包含了 p 元素的 div 
</td></tr><tr><td><strong>:not(selector)</strong></td><td>
 div:not(.logo) 表示不包含 class=logo 元素的所有 div 列表
</td></tr><tr><td><strong>:contains(text)</strong></td><td>
包含某文本的元素，不区分大小写，例如 p:contains(oschina) 
</td></tr><tr><td><strong>:containsOwn(text)</strong></td><td>
文本信息完全等于指定条件的过滤
</td></tr><tr><td><strong>:matches(regex)</strong></td><td>
使用正则表达式进行文本过滤：div:matches((?i)login) 
</td></tr><tr><td><strong>:matchesOwn(regex)</strong></td><td>
使用正则表达式找到自身的文本
</td></tr></tbody></table><h2 id="7总结outline" class="ibm-h2">总结</h2><p>jsoup 的基本功能到这里就介绍完毕，但由于 jsoup 良好的可扩展性 API 设计，你可以通过选择器的定义来开发出非常强大的 HTML 解析功能。再加上 jsoup 项目本身的开发也非常活跃，因此如果你正在使用 Java ，需要对 HTML 进行处理，不妨试试。</p><!--CMA ID: 630256--><!--Site ID: 10--><!--XSLT stylesheet used to transform this file: dw-document-html-8.0.xsl-->
                                        <!-- Article Quiz -->
                                        
                                        <!-- Article Resources -->
                                        <div class="ibm-alternate-rule"><hr/></div><h4 id="artrelatedtopics" class="ibm-h4">相关主题</h4><ul><li>
 jsoup 官方网站：<a href="http://jsoup.org/">http://jsoup.org</a></li><li>
开源中国社区上 jsoup 的一些代码片段：<a href="http://www.oschina.net/code/list_by_project?id=12689">http://www.oschina.net/code/list_by_project?id=12689</a></li><li>
 Htmlparser 项目介绍：<a href="http://www.oschina.net/p/htmlparser">http://www.oschina.net/p/htmlparser</a></li><li>
 jQuery 项目介绍：<a href="http://www.oschina.net/p/jquery">http://www.oschina.net/p/jquery</a></li><li>
更多开源项目的介绍来自开源中国社区：<a href="http://www.oschina.net/">http://www.oschina.net</a></li><li><a href="http://www.ibm.com/developerworks/cn/java/">developerWorks Java 技术专区</a>： 这里有数百篇关于 Java 编程每个方面的文章。</li><li>查看 <a href="http://www.ibm.com/developerworks/cn/web/lp/html5/">HTML5 专题</a>，了解更多和 HTML5 相关的知识和动向。</li></ul>
                                        <!-- Commenting -->
<!-- INLINE_COMMENTS_BEGIN: -->
<div class="ibm-alternate-rule"><hr/></div>
<div id="dw-article-cmts-top" class="ibm-columns">
    <div class="ibm-col-6-2">
        <h4 id="icomments" class="ibm-h4">评论</h4>
        <div id="dw-article-cmts-login">
            <p>添加或订阅评论，请先<a onClick="window.location=userLinks[0].url;" tabindex="0" role="link">登录</a>或<a onClick="window.location=userLinks[1].url;" tabindex="0" role="link">注册</a>。</p>
        </div>
    </div>    
    <div class="ibm-col-6-2" id="dw-notify"> 
        <input type="checkbox" value="1" name="comment_notification" id="comment_notification" disabled="disabled">
        <label for="comment_notification">有新评论时提醒我</label>	   
    </div>
</div>

<div class="dw-article-cmts-container">       
    <div class="ibm-no-print" id="dw-icomments-container">	
        
    </div>
</div>
<!-- INLINE_COMMENTS_END -->                                        <!-- CENTER_6_4_CONTENT_COLUMN_END -->
                                    </div>   
                                </div>
                        <!--Rating_Meta_BEGIN--><div class="metavalue">static.content.url=http://www.ibm.com/developerworks/js/artrating/</div><div class="metavalue">SITE_ID=10</div><div class="metavalue">Zone=Java technology, Web development</div><div class="metavalue">ArticleID=630256</div><div class="metavalue">ArticleTitle=使用 jsoup 对 HTML 文档进行解析和操作</div><div class="metavalue">publish-date=03022011</div><script language="javascript" type="text/javascript">document.write('<div class="metavalue">url='+location.href.replace(/</g,  '%3C')+'</div>');</script><!--Rating_Meta_END-->
                    </div>
                    <!-- END_IBM-CONTENT-MAIN -->
                </div>
                <!-- END_IBM-CONTENT-BODY -->
            </div>
            <!-- END_IBM-CONTENT -->
        </div>
        <!-- END_IBM-PCON -->
    </main>
    <!-- MAIN_CONTENT_END -->
    
    <!-- END_CONTENT-WRAPPER -->	
</div>
<!-- FOOTER_BEGIN -->
<footer role="contentinfo" aria-label="IBM Developer">
    <div id="dw-footer-module" class="dw-footer-home ibmdeveloper">
        <section aria-label="参考资料" role="contentinfo">
            <div class="ibm-columns">
                <div class="ibm-col-6-1 dw-footer-col-1">
                    <ul>
                        <li class="dw-footer-heading" aria-label="IBM Developer"><a href="//www.ibm.com/developerworks/cn/">IBM <b>Developer</b></a></li>
                        <li><a href="//www.ibm.com/developerworks/secure/feedback.jsp?domain=dwchina">站点反馈</a></li>
                        <li class="dw-footer-newline"><a href="//www.ibm.com/developerworks/secure/myideas2.jsp?domain=dwchina">我要投稿</a></li>
                        <li class="dw-footer-newline"><a href="//www.ibm.com/developerworks/community/report?lang=zh">报告滥用</a></li>
                        <li class="dw-footer-newline"><a href="//www.ibm.com/developerworks/cn/community/terms/thirdparty/">第三方提示</a></li>
                    </ul>
                    <ul>
                        <li class="dw-footer-newline"><a href="//weibo.com/ibmdw/">关注微博</a></li>
                    </ul>
                </div>
                <div class="ibm-col-6-1 dw-footer-col-2">
                    <ul>
                        <li class="dw-footer-heading"><a href="//www-31.ibm.com/ibm/cn/ur/">大学合作</a></li>
                    </ul>
                    <ul class="dw-footer-lang" aria-label="选择语言">
                        <li class="dw-footer-heading">选择语言</li>
                        <li><a href="//developer.ibm.com">English</a></li>
                        <li><a href="//www.ibm.com/developerworks/cn/" lang="zh">中文</a></li>
                        <li><a href="//www.ibm.com/developerworks/jp/" lang="ja">日本語</a></li>
                        <li><a href="//www.ibm.com/developerworks/ru/" lang="ru">Русский</a></li>
                        <li class="dw-footer-newline"><a href="//www.ibm.com/developerworks/br/" lang="pt">Português (Brasil)</a></li>
                        <li><a href="//www.ibm.com/developerworks/ssa/" lang="es">Español</a></li>
                        <li><a href="//developer.ibm.com/kr/" lang="kr">한글</a></li>
                    </ul>
                </div>
                <div class="ibm-col-6-1 dw-footer-col-3"> </div>
                <div class="ibm-col-6-1 dw-footer-col-4"> </div>
                <div class="ibm-col-6-1 dw-footer-col-5">
                    <ul class="dw-footer-categories">
                        <li class="dw-footer-category">
                            <a href="//developer.ibm.com/cn/journey/">Code patterns</a>  
                        </li>
                        <li class="dw-footer-category">
                            <a href="//www.ibm.com/developerworks/cn/views/global/libraryview.jsp">技术文档库</a>
                        </li>
                        <li class="dw-footer-category">
                            <a href="//www.ibm.com/developerworks/cn/downloads/">软件下载</a>  
                        </li>
                        <li class="dw-footer-category">
                            <a href="//developer.ibm.com/cn/">开发者中心</a>  
                        </li>
                        <li class="dw-footer-category">
                            <a href="//www.ibm.com/developerworks/cn/rss/">订阅源</a>  
                        </li>

                    </ul>
                </div>
                <div class="ibm-col-6-1 dw-footer-col-6">
                    <ul class="dw-footer-categories">
                        <li class="dw-footer-category">
                            <a href="//www.pages03.net/ibmdeveloperworks/developerWorksChina-NewsletterSubscriptionPage-secure18rev1/">时事通讯</a>  
                        </li>
                        <li class="dw-footer-category">
                            <a href="//developer.ibm.com/cn/tv/">视频</a>  
                        </li>
                        <li class="dw-footer-category">
                            <a href="//developer.ibm.com/cn/blogs/">博客</a>  
                        </li>
                        <li class="dw-footer-category">
                            <a href="//developer.ibm.com/cn/events/">活动</a>  
                        </li>                        
                        <li class="dw-footer-category">
                            <a href="//www.ibm.com/developerworks/cn/community/">社区</a>  
                        </li>
                    </ul>
                </div>
            </div>
        </section>
    </div>
    <div id="dw-footer" class="ibm-padding-normal ibm-alternate">
        <div class="ibm-columns">
            <div class="ibm-col-1-1">
                <div class="dw-footer-corporate-links">
                <ul>
                    <li><a href="//www.ibm.com/contact/cn/zh/">联系 IBM</a></li>
                    <li><a href="//www.ibm.com/privacy/cn/zh/">隐私条约</a></li>
                    <li><a href="//www.ibm.com/developerworks/cn/community/terms/use/">使用条款</a></li>
                    <li><a href="//www.ibm.com/accessibility/cn/zh/">信息无障碍选项</a></li>
                    <li class="ibm-feedbacklink"><a href="#">反馈</a></li>
                    <li id="ibm-truste-cp"><a onclick="truste.eu.clickListener();return false;" href="#">Cookie 首选项</a></li>
                </ul>                 
                </div>    
            </div>
        </div>
    </div>        
</footer> <!-- FOOTER_END -->

<!-- END_IBM-TOP -->
</div>

<!-- SCRIPTS_INCLUDE_BEGIN -->
<!-- Styles -->
<link rel="stylesheet" type="text/css" href="/developerworks/maverick/css/plugin/comments/jquery-comments.css">
<link rel="stylesheet" href="/developerworks/maverick/fonts/awesome-4.5.0/css/font-awesome.min.css">

<!-- Libraries -->
<script type="text/javascript" src="/developerworks/maverick/js/plugin/comments/jquery-comments.min.js"></script>
<script type="text/javascript" src="/developerworks/maverick/js/plugin/formatter/moment-with-locales.js"></script>
<script type="text/javascript" src="/developerworks/maverick/js/ContentComments.js"></script>
<script type="text/javascript" src="/developerworks/js/v18/ContentCommentsFormatter.js"></script>
<script type="text/javascript" language="JavaScript">

	IBMCore.common.module.masthead.subscribe("ready", "customjs", setupCommentsPlugin).runAsap(setupCommentsPlugin);

	function setupCommentsPlugin(){
		//debugger;
			//alert(userLinks);
			var commentsInitInfo = {
				contentId : $("div[class=metavalue]:contains('ArticleID=')").text().split("=")[1],
				siteId :  $("div[class=metavalue]:contains('SITE_ID=')").text().split("=")[1],
				pluginDivId : '#dw-icomments-container',
				notifyElementId : "#comment_notification",
				loginMessageDivId : "#dw-article-cmts-login",
				totalCommentsDivId : "#nCmts",
						isIdea:false

			};				
								
			ContentComments.Setup(commentsInitInfo);
	}
</script>

<!-- SCRIPTS_INCLUDE_END -->

</body>
</html>
